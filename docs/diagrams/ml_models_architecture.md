# ML Models Architecture Diagrams

## Hybrid Recommendation System Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     HYBRID RECOMMENDATION SYSTEM                           │
│                                                                             │
│  User Input ───────────────────────────────┐                               │
│  Item Features ────────────────────────────┤                               │
│  User-Item Interactions ───────────────────┤                               │
│                                            │                               │
│                                            ▼                               │
│  ┌─────────────────────┐              ┌─────────────────────┐              │
│  │ Collaborative       │              │ Content-Based       │              │
│  │ Filtering Model     │              │ Recommender         │              │
│  │                     │              │                     │              │
│  │ ┌─────────────────┐ │              │ ┌─────────────────┐ │              │
│  │ │  User Embedding │ │              │ │ Feature         │ │              │
│  │ │  (50 dims)      │ │              │ │ Engineering     │ │              │
│  │ └─────────────────┘ │              │ │ - Location      │ │              │
│  │ ┌─────────────────┐ │              │ │ - Price         │ │              │
│  │ │  Item Embedding │ │              │ │ - Amenities     │ │              │
│  │ │  (50 dims)      │ │              │ │ - Bedrooms      │ │              │
│  │ └─────────────────┘ │              │ └─────────────────┘ │              │
│  │ ┌─────────────────┐ │              │ ┌─────────────────┐ │              │
│  │ │  Neural Network │ │              │ │  Deep Neural    │ │              │
│  │ │  128→64→32→1    │ │              │ │  Network        │ │              │
│  │ └─────────────────┘ │              │ │  256→128→64→1   │ │              │
│  └─────────────────────┘              │ └─────────────────┘ │              │
│           │                           └─────────────────────┘              │
│           │                                      │                         │
│           ▼                                      ▼                         │
│  ┌─────────────────────┐              ┌─────────────────────┐              │
│  │ CF Predictions      │              │ CB Predictions      │              │
│  │ Score: 0.0 - 1.0    │              │ Score: 0.0 - 1.0    │              │
│  └─────────────────────┘              └─────────────────────┘              │
│           │                                      │                         │
│           └──────────────┐      ┌────────────────┘                         │
│                          │      │                                          │
│                          ▼      ▼                                          │
│                    ┌─────────────────────┐                                 │
│                    │ Hybrid Combiner     │                                 │
│                    │                     │                                 │
│                    │ CF Weight: 0.6      │                                 │
│                    │ CB Weight: 0.4      │                                 │
│                    │                     │                                 │
│                    │ Final Score =       │                                 │
│                    │ 0.6*CF + 0.4*CB     │                                 │
│                    └─────────────────────┘                                 │
│                              │                                             │
│                              ▼                                             │
│                    ┌─────────────────────┐                                 │
│                    │ Ranked              │                                 │
│                    │ Recommendations     │                                 │
│                    │ + Explanations      │                                 │
│                    └─────────────────────┘                                 │
└─────────────────────────────────────────────────────────────────────────────┘
```

## NLP Search Ranker Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        NLP SEARCH RANKER                                   │
│                                                                             │
│  Search Query: "2 bedroom apartment downtown with gym"                     │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Text Preprocessing                               │   │
│  │ - Tokenization                                                      │   │
│  │ - Normalization                                                     │   │
│  │ - Truncation (max 512 tokens)                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │              Transformer Encoder                                   │   │
│  │         (sentence-transformers/all-MiniLM-L6-v2)                   │   │
│  │                                                                     │   │
│  │  Input: [CLS] query tokens [SEP]                                   │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │  Multi-Head Attention Layers                               │   │   │
│  │  │  ┌───────────┐ ┌───────────┐ ┌───────────┐                │   │   │
│  │  │  │ Attention │ │ Attention │ │ Attention │                │   │   │
│  │  │  │  Head 1   │ │  Head 2   │ │  Head N   │                │   │   │
│  │  │  └───────────┘ └───────────┘ └───────────┘                │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │  Feed Forward Network                                      │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │  Output: [CLS] embedding (384 dims)                                │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                Property Text Encoding                              │   │
│  │                                                                     │   │
│  │  Property 1: "Luxury 2BR downtown, gym, pool"                     │   │
│  │  Property 2: "Studio apartment near park"                         │   │
│  │  Property N: "3BR house with garage"                              │   │
│  │                              │                                     │   │
│  │                              ▼                                     │   │
│  │         Same Transformer Encoder                                   │   │
│  │                              │                                     │   │
│  │                              ▼                                     │   │
│  │  Property Embeddings: [384 dims] × N properties                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                  Neural Ranking Model                              │   │
│  │                                                                     │   │
│  │  Query Embedding [384] ──┐                                        │   │
│  │                           │                                        │   │
│  │  Property Embedding [384] ┤                                       │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │                    Concatenate [768]                               │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │                    Dense(512, ReLU)                                │   │
│  │                           │                                        │   │
│  │                     Dropout(0.3)                                   │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │                    Dense(256, ReLU)                                │   │
│  │                           │                                        │   │
│  │                     Dropout(0.3)                                   │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │                    Dense(128, ReLU)                                │   │
│  │                           │                                        │   │
│  │                     Dropout(0.2)                                   │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │                   Dense(1, Sigmoid)                                │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │                 Relevance Score [0.0-1.0]                         │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Ranking Results                                 │   │
│  │                                                                     │   │
│  │  Property 1: Score 0.95 (High relevance)                          │   │
│  │  Property 3: Score 0.87 (Good match)                              │   │
│  │  Property 2: Score 0.23 (Low relevance)                           │   │
│  │  ...                                                               │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Collaborative Filtering Model Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    COLLABORATIVE FILTERING MODEL                           │
│                                                                             │
│  User-Item Interaction Matrix                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │        Item1  Item2  Item3  ...  ItemN                             │   │
│  │  User1   1     0     1    ...    0                                 │   │
│  │  User2   0     1     1    ...    1                                 │   │
│  │  User3   1     1     0    ...    0                                 │   │
│  │  ...    ...   ...   ...   ...   ...                               │   │
│  │  UserM   0     0     1    ...    1                                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │              Neural Collaborative Filtering                        │   │
│  │                                                                     │   │
│  │  User ID Input ──────────┐                                        │   │
│  │                           │                                        │   │
│  │  Item ID Input ──────────┤                                        │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                  Embedding Layers                          │   │   │
│  │  │                                                             │   │   │
│  │  │  User Embedding                Item Embedding              │   │   │
│  │  │  ┌─────────────────┐           ┌─────────────────┐         │   │   │
│  │  │  │   User Vector   │           │   Item Vector   │         │   │   │
│  │  │  │   [50 dims]     │           │   [50 dims]     │         │   │   │
│  │  │  │                 │           │                 │         │   │   │
│  │  │  │ - Preferences   │           │ - Features      │         │   │   │
│  │  │  │ - Patterns      │           │ - Categories    │         │   │   │
│  │  │  │ - Behavior      │           │ - Popularity    │         │   │   │
│  │  │  └─────────────────┘           └─────────────────┘         │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                    Flatten                                  │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │               Concatenate [100 dims]                       │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                           │                                        │   │
│  │                           ▼                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                Deep Neural Network                         │   │   │
│  │  │                                                             │   │   │
│  │  │  Dense(128, ReLU) + Dropout(0.2)                          │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Dense(64, ReLU) + Dropout(0.2)                           │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Dense(32, ReLU)                                           │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Dense(1, Sigmoid)                                         │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Prediction [0.0-1.0]                                     │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                Training Process                                     │   │
│  │                                                                     │   │
│  │  Positive Samples: Known interactions (rating > 0)                 │   │
│  │  Negative Samples: Random unobserved interactions                   │   │
│  │                                                                     │   │
│  │  Loss: Binary Crossentropy                                         │   │
│  │  Optimizer: Adam (lr=0.001)                                        │   │
│  │  Metrics: MAE, MSE, Accuracy                                       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Content-Based Recommender Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   CONTENT-BASED RECOMMENDER                                │
│                                                                             │
│  Property Features                                                          │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  Location: "Downtown Manhattan"                                    │   │
│  │  Price: $3500/month                                                │   │
│  │  Bedrooms: 2                                                       │   │
│  │  Bathrooms: 1.5                                                    │   │
│  │  Amenities: ["gym", "pool", "parking", "pet-friendly"]            │   │
│  │  Square Feet: 850                                                  │   │
│  │  Property Type: "apartment"                                        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                 Feature Engineering                                │   │
│  │                                                                     │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────────────┐  │   │
│  │  │   Location    │  │     Price     │  │      Amenities        │  │   │
│  │  │   Features    │  │   Features    │  │      Features         │  │   │
│  │  │               │  │               │  │                       │  │   │
│  │  │ Label Encoder │  │ StandardScaler│  │   TF-IDF Vectorizer   │  │   │
│  │  │      │        │  │       │       │  │           │           │  │   │
│  │  │      ▼        │  │       ▼       │  │           ▼           │  │   │
│  │  │ [0,1,2,...,N] │  │  [-1.2, 0.8] │  │   [0.2, 0, 0.5, ...]  │  │   │
│  │  │  (Categorical)│  │  (Normalized) │  │    (Sparse Vector)    │  │   │
│  │  └───────────────┘  └───────────────┘  └───────────────────────┘  │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                Multi-Input Neural Network                          │   │
│  │                                                                     │   │
│  │  Location Input [1] ──────┐                                       │   │
│  │          │                │                                       │   │
│  │          ▼                │                                       │   │
│  │  Embedding(1000, 64) ─────┤                                       │   │
│  │                            │                                       │   │
│  │  Price Input [2] ──────────┤                                       │   │
│  │                            │                                       │   │
│  │  Amenity Input [500] ──────┤                                       │   │
│  │                            │                                       │   │
│  │                            ▼                                       │   │
│  │               Concatenate [566 dims]                               │   │
│  │                            │                                       │   │
│  │                            ▼                                       │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                Deep Feature Learning                       │   │   │
│  │  │                                                             │   │   │
│  │  │  Dense(256, ReLU) + Dropout(0.3)                          │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Dense(128, ReLU) + Dropout(0.3)                          │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Dense(64, ReLU) + Dropout(0.2)                           │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Dense(1, Sigmoid)                                         │   │   │
│  │  │            │                                               │   │   │
│  │  │            ▼                                               │   │   │
│  │  │  Preference Score [0.0-1.0]                               │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              │                                             │
│                              ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                Content Similarity Matrix                           │   │
│  │                                                                     │   │
│  │  ┌───────────────────────────────────────────────────────────────┐ │   │
│  │  │         Property Feature Vectors [64 dims each]              │ │   │
│  │  │                                                               │ │   │
│  │  │  Property 1: [0.2, 0.8, -0.3, ...]                          │ │   │
│  │  │  Property 2: [0.1, 0.9, -0.1, ...]                          │ │   │
│  │  │  Property 3: [-0.5, 0.2, 0.8, ...]                          │ │   │
│  │  │                                                               │ │   │
│  │  │                    ▼                                          │ │   │
│  │  │               Cosine Similarity                               │ │   │
│  │  │                                                               │ │   │
│  │  │        Similarity Matrix [N x N]                             │ │   │
│  │  │  ┌─────────────────────────────────────────────────────┐    │ │   │
│  │  │  │      P1    P2    P3   ...   PN                     │    │ │   │
│  │  │  │ P1 │ 1.0   0.8   0.2  ...  0.1 │                  │    │ │   │
│  │  │  │ P2 │ 0.8   1.0   0.3  ...  0.2 │                  │    │ │   │
│  │  │  │ P3 │ 0.2   0.3   1.0  ...  0.9 │                  │    │ │   │
│  │  │  │... │ ... │ ... │ ... │... │ ...│                  │    │ │   │
│  │  │  │ PN │ 0.1   0.2   0.9  ...  1.0 │                  │    │ │   │
│  │  │  └─────────────────────────────────────────────────────┘    │ │   │
│  │  └───────────────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```